# ============================================================
# CONFIGURACIÓN PRINCIPAL DE LA APLICACIÓN
# ============================================================
# Este archivo contiene toda la configuración del microservicio
# de Spring Batch para procesamiento de datos por lotes.
# ============================================================

# Configuración del servidor
server:
  port: 8080
  servlet:
    context-path: /api

# Configuración de Spring
spring:
  application:
    name: spring-batch-boot
  
  # ============================================
  # CONFIGURACIÓN DE BASE DE DATOS MySQL
  # ============================================
  datasource:
    # URL de conexión a MySQL
    # Formato: jdbc:mysql://host:puerto/nombre_base_datos
    url: jdbc:mysql://localhost:3306/spring_batch_db?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true
    username: jdanielmq
    password: JdmQ1481
    driver-class-name: com.mysql.cj.jdbc.Driver
    
    # Configuración del pool de conexiones HikariCP
    hikari:
      # Tamaño máximo del pool de conexiones
      maximum-pool-size: 10
      # Tamaño mínimo de conexiones inactivas
      minimum-idle: 5
      # Tiempo máximo de espera para obtener conexión (30 segundos)
      connection-timeout: 30000
      # Tiempo máximo de vida de una conexión (30 minutos)
      max-lifetime: 1800000
      # Tiempo máximo de inactividad (10 minutos)
      idle-timeout: 600000
  
  # ============================================
  # CONFIGURACIÓN DE JPA/HIBERNATE
  # ============================================
  jpa:
    # Mostrar SQL en consola (útil para desarrollo)
    show-sql: true
    # Estrategia de creación de tablas
    hibernate:
      # Opciones: none, validate, update, create, create-drop
      ddl-auto: update
    properties:
      hibernate:
        # Formato del SQL mostrado
        format_sql: true
        # Dialecto de MySQL 8
        dialect: org.hibernate.dialect.MySQLDialect
  
  # ============================================
  # CONFIGURACIÓN DE SPRING BATCH
  # ============================================
  batch:
    # Crear automáticamente las tablas de metadatos de Spring Batch
    jdbc:
      initialize-schema: always
    job:
      # No ejecutar jobs automáticamente al iniciar la aplicación
      enabled: false

# ============================================
# CONFIGURACIÓN DE LOGGING
# ============================================
logging:
  level:
    # Nivel de log para nuestra aplicación
    com.ejemplo: DEBUG
    # Nivel de log para Spring Batch
    org.springframework.batch: INFO
    # Nivel de log para Hibernate SQL
    org.hibernate.SQL: DEBUG
    # Nivel de log para parámetros de Hibernate
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
  pattern:
    # Formato del log en consola
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"

# ============================================
# CONFIGURACIÓN DE SPRINGDOC/SWAGGER
# ============================================
springdoc:
  api-docs:
    enabled: true
    path: /v3/api-docs
  swagger-ui:
    enabled: true
    path: /swagger-ui.html
    operations-sorter: method
    tags-sorter: alpha

# ============================================
# CONFIGURACIÓN PERSONALIZADA DEL BATCH
# ============================================
batch:
  config:
    # Tamaño del chunk (número de registros procesados por transacción)
    chunk-size: 100
    # Número de registros a saltar en caso de error
    skip-limit: 10

